<%- include('../partials/headers') %>
<%- include('../partials/sidebar') %>

<div class="content-wrapper">
    <!-- Page Header -->
    <section class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1>Add New Instructor</h1>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="content">
        <div class="container-fluid">
            <div class="card card-primary card-outline shadow-sm">
                <div class="card-header">
                    <h3 class="card-title">Instructor Details</h3>
                </div>

           

                <!-- Flash messages -->
<% if (success) { %>
<div class="alert alert-success alert-dismissible fade show" role="alert">
    <%= success %>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
<% } %>

<% if (error) { %>
<div class="alert alert-danger alert-dismissible fade show" role="alert">
    <%= error %>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
<% } %>

<% if (errors && errors.length > 0) { %>
<div class="alert alert-danger">
    <ul>
        <% errors.forEach(function(err) { %>
            <li><%= err %></li>
        <% }); %>
    </ul>
</div>
<% } %>

                <!-- âœ… Instructor Form -->
                <form action="/admin/instructors" method="POST" enctype="multipart/form-data">
                    <div class="card-body row g-3">

                        <!-- First Name -->
                        <div class="col-md-6 mb-3">
                            <label for="first_name" class="form-label">First Name <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="first_name" name="first_name"
                                value="<%= oldInput?.first_name || '' %>" required />
                        </div>

                        <!-- Last Name -->
                        <div class="col-md-6 mb-3">
                            <label for="last_name" class="form-label">Last Name <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="last_name" name="last_name"
                                value="<%= oldInput?.last_name || '' %>" required />
                        </div>

                        <!-- Email -->
                        <div class="col-md-6 mb-3">
                            <label for="email" class="form-label">Email <span class="text-danger">*</span></label>
                            <input type="email" class="form-control" id="email" name="email"
                                value="<%= oldInput?.email || '' %>" required />
                        </div>

                        <!-- Phone -->
                        <div class="col-md-6 mb-3">
                            <label for="phone" class="form-label">Phone</label>
                            <input type="text" class="form-control" id="phone" name="phone"
                                value="<%= oldInput?.phone || '' %>" placeholder="e.g. 9876543210" />
                        </div>

                        <!-- Password -->
                        <!-- <div class="col-md-6 mb-3">
                            <label for="password_hash" class="form-label">Password <span class="text-danger">*</span></label>
                            <input type="password" class="form-control" id="password_hash" name="password_hash"
                                placeholder="Enter password" required />
                        </div> -->

                        <!-- Experience -->
                        <div class="col-md-6 mb-3">
                            <label for="experience_years" class="form-label">Experience (Years)</label>
                            <input type="number" min="0" class="form-control" id="experience_years"
                                name="experience_years" value="<%= oldInput?.experience_years || '' %>" />
                        </div>

                        <!-- Specialization -->
                        <!-- <div class="col-md-6 mb-3">
                            <label for="specialization" class="form-label">Specialization</label>
                            <input type="text" class="form-control" id="specialization" name="specialization"
                                value="</%= oldInput?.specialization || '' %>" />
                        </div> -->

                        <!-- Services -->
<div class="col-md-6 mb-3">
    <label for="service_id" class="form-label">
        Services <span class="text-danger">*</span>
    </label>

    <select class="form-select" id="service_id" name="service_id" required>
        <option value="">-- Select Service --</option>

        <% if (classTypes && classTypes.length > 0) { %>
            <% classTypes.forEach(function(service) { %>
                <option 
                    value="<%= service.id %>"
                    <%= oldInput?.service_id == service.id ? 'selected' : '' %>
                >
                    <%= service.name %>
                </option>
            <% }); %>
        <% } %>
    </select>
</div>

                        <!-- Rating -->
                        <div class="col-md-6 mb-3">
                            <label for="rating" class="form-label">Rating (0.0 - 5.0)</label>
                            <input type="number" step="0.1" min="0" max="5" class="form-control" id="rating"
                                name="rating" value="<%= oldInput?.rating || '' %>" />
                        </div>

                        <!-- Bio -->
                        <div class="col-md-12 mb-3">
                            <label for="bio" class="form-label">Bio</label>
                            <textarea class="form-control" id="bio" name="bio" rows="4"
                                placeholder="Write a short bio..."><%= oldInput?.bio || '' %></textarea>
                        </div>

                        <!-- Status -->
                        <div class="col-md-6 mb-3">
                            <label for="status" class="form-label">Status</label>
                            <select class="form-select" id="status" name="status">
                                <option value="active" <%= oldInput?.status === 'active' ? 'selected' : '' %>>Active</option>
                                <option value="inactive" <%= oldInput?.status === 'inactive' ? 'selected' : '' %>>Inactive</option>
                            </select>
                        </div>

                        <!-- Image Upload -->
                        <div class="col-md-12 mb-3">
                            <label for="image" class="form-label">Profile Image</label>
                            <div class="input-group">
                                <input type="file" class="form-control" id="image" name="image" accept="image/*" />
                                <label class="input-group-text" for="image">Upload</label>
                            </div>
                            <% if (oldInput?.image) { %>
                                <div class="mt-2">
                                    <img src="/uploads/instructors/<%= oldInput.image %>" alt="Instructor Image" class="img-thumbnail" style="max-width:150px;">
                                </div>
                            <% } %>
                        </div>

                    </div>

                    <div class="card-footer text-end">
                        <button type="reset" class="btn btn-secondary me-2">Reset</button>
                        <button type="submit" class="btn btn-primary">Save Instructor</button>
                    </div>
                </form>
            </div>
        </div>
    </section>
</div>

<%- include('../partials/footer') %>
